{% if request.user_agent.is_mobile %}
    {% if google_square_ad %}
        <script>
            // JS code define a first google ad in latest and details page in mobile device
            window.googletag = window.googletag || {cmd: []};
            googletag.cmd.push(function () {
                googletag.defineSlot("{{ google_square_ad.ad_unit_path }}",
                    [{{ google_square_ad.ad_width }}, {{ google_square_ad.ad_height }}],
                    "{{ google_square_ad.ad_unit_id}}").setTargeting('test', 'infinitescroll').addService(googletag.pubads());
                googletag.pubads().enableSingleRequest();
                googletag.pubads().collapseEmptyDivs(true);
                googletag.pubads().setCentering(true);
                googletag.enableServices();
            });

            // Function to generate google ad units (Pagination ads) in mobile device.
            function generate_ad_unit(id_name) {
                // Define the slot itself, register it and fetch an ad.
                googletag.cmd.push(function () {
                    var slot = googletag.defineSlot("{{ google_square_ad.ad_unit_path }}",
                        [{{ google_square_ad.ad_width }}, {{ google_square_ad.ad_height }}])
                        .setTargeting('test', 'infinitescroll')
                        .addService(googletag.pubads());
                    googletag.pubads().enableSingleRequest();
                    googletag.pubads().collapseEmptyDivs(true);
                    var div = document.createElement('div');
                    div.id = slot.getSlotElementId(); // auto-generated by GPT
                    $("#" + id_name).append(div);
                    googletag.display(slot);
                });
            }
        </script>
    {% endif %}
{% else %}
    {% if google_desktop_horizontal_ad %}
        <script>
            // JS code define a first google ad in latest and details page in desktop device
            window.googletag = window.googletag || {cmd: []};
            googletag.cmd.push(function () {
                googletag.defineSlot("{{ google_desktop_horizontal_ad.ad_unit_path }}",
                    [{{ google_desktop_horizontal_ad.ad_width }}, {{ google_desktop_horizontal_ad.ad_height }}],
                    "{{ google_desktop_horizontal_ad.ad_unit_id }}").setTargeting('test', 'infinitescroll').addService(googletag.pubads());
                googletag.pubads().enableSingleRequest();
                googletag.pubads().collapseEmptyDivs(true);
                googletag.pubads().setCentering(true);
                googletag.enableServices();
            });

            // Function to generate google ad units (Pagination ads) in desktop device.
            function generate_ad_unit(id_name) {
                // Define the slot itself, register it and fetch an ad.
                googletag.cmd.push(function () {
                    var slot = googletag.defineSlot("{{ google_desktop_horizontal_ad.ad_unit_path }}",
                        [{{ google_desktop_horizontal_ad.ad_width }}, {{ google_desktop_horizontal_ad.ad_height }}])
                        .setTargeting('test', 'infinitescroll')
                        .addService(googletag.pubads());
                    googletag.pubads().enableSingleRequest();
                    googletag.pubads().collapseEmptyDivs(true);
                    var div = document.createElement('div');
                    div.id = slot.getSlotElementId(); // auto-generated by GPT
                    $("#" + id_name).append(div);
                    googletag.display(slot);
                });
            }
        </script>
    {% endif %}
{% endif %}